<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MOBE INVITE SYSTEM</title>
  <link rel="icon" href="https://assets.onecompiler.app/42swzbgaa/433g7msea/1000049145.png" type="image/png">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- QR Code Library -->
  <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
  
  <style>
    :root {
      --primary: #00FFCD;
      --secondary: #0099FF;
      --accent: #FF00AA;
      --dark: #0A0A2A;
      --light: #E0F8FF;
      --glow: 0 0 15px currentColor;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      color: var(--light);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    
    /* Main Container */
    .share-container {
      background: rgba(10, 10, 42, 0.9);
      border-radius: 15px;
      padding: 30px;
      width: 100%;
      max-width: 500px;
      box-shadow: 0 0 30px rgba(0, 153, 255, 0.3);
      backdrop-filter: blur(10px);
      border: 1px solid var(--primary);
      text-align: center;
    }
    
    /* Header */
    .share-header {
      margin-bottom: 25px;
    }
    
    .share-title {
      font-size: 2rem;
      color: var(--primary);
      text-shadow: var(--glow);
      margin-bottom: 10px;
    }
    
    .share-subtitle {
      color: var(--secondary);
      font-size: 1rem;
    }
    
    /* Buttons */
    .button-group {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 25px;
    }
    
    .share-button {
      padding: 15px 25px;
      border: none;
      border-radius: 8px;
      font-family: 'Orbitron', sans-serif;
      font-weight: bold;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    
    .share-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: 0.5s;
      z-index: -1;
    }
    
    .share-button:hover::before {
      left: 100%;
    }
    
    .btn-primary {
      background: linear-gradient(45deg, var(--primary), var(--secondary));
      color: var(--dark);
      box-shadow: 0 0 15px rgba(0, 255, 205, 0.5);
    }
    
    .btn-secondary {
      background: linear-gradient(45deg, var(--secondary), var(--accent));
      color: white;
      box-shadow: 0 0 15px rgba(0, 153, 255, 0.5);
    }
    
    .btn-tertiary {
      background: linear-gradient(45deg, var(--accent), #FF00FF);
      color: white;
      box-shadow: 0 0 15px rgba(255, 0, 170, 0.5);
    }
    
    .share-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 0 25px currentColor;
    }
    
    .share-button:active {
      transform: translateY(0);
    }
    
    /* QR Code Section */
    .qrcode-section {
      margin-top: 20px;
      display: none;
    }
    
    .qrcode-wrapper {
      background: white;
      padding: 15px;
      border-radius: 10px;
      display: inline-block;
      margin-bottom: 20px;
      border: 3px solid var(--primary);
      box-shadow: 0 0 20px rgba(0, 255, 205, 0.3);
    }
    
    #qrcode {
      width: 200px;
      height: 200px;
    }
    
    .qrcode-wrapper img {
      position: absolute;
      top: 59%;
      left: 49%;
      transform: translate(-50%, -50%);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid white;
    }
    
    /* Link Section */
    .link-section {
      margin-top: 20px;
      display: none;
    }
    
    .link-container {
      display: flex;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      overflow: hidden;
      border: 1px solid var(--secondary);
    }
    
    #shareLink {
      flex: 1;
      padding: 12px 15px;
      background: transparent;
      border: none;
      color: white;
      font-family: 'Orbitron', sans-serif;
      outline: none;
    }
    
    .copy-btn {
      padding: 0 15px;
      background: var(--secondary);
      color: white;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .copy-btn:hover {
      background: var(--primary);
    }
    
    /* Stats Section */
    .stats-section {
      margin-top: 25px;
      display: flex;
      justify-content: space-around;
      text-align: center;
    }
    
    .stat-item {
      padding: 10px;
    }
    
    .stat-value {
      font-size: 1.5rem;
      color: var(--primary);
      font-weight: bold;
    }
    
    .stat-label {
      font-size: 0.8rem;
      color: var(--secondary);
      margin-top: 5px;
    }
    
    /* Notification */
    .notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 255, 205, 0.9);
      color: var(--dark);
      padding: 10px 20px;
      border-radius: 5px;
      box-shadow: 0 0 15px rgba(0, 255, 205, 0.5);
      z-index: 100;
      display: none;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .share-container {
        padding: 20px;
      }
      
      .share-title {
        font-size: 1.5rem;
      }
      
      .button-group {
        gap: 10px;
      }
      
      .share-button {
        padding: 12px 20px;
        font-size: 1rem;
      }
      
      #qrcode {
        width: 200px;
        height: 200px;
      }
    }
  </style>
</head>
<body>
  <!-- Notification -->
  <div class="notification" id="notification"></div>
  
  <!-- Main Container -->
  <div class="share-container">
    <div class="share-header">
      <h1 class="share-title"><i class="fas fa-share-alt"></i> MOBE INVITE</h1>
      <p class="share-subtitle">Invite friends to join MOBE WINTERLAND</p>
    </div>
    
    <div class="button-group">
      <button class="share-button btn-primary" id="shareBtn">
        <i class="fas fa-share"></i> Share Invite Link
      </button>
      <button class="share-button btn-secondary" id="qrBtn">
        <i class="fas fa-qrcode"></i> Generate QR Code
      </button>
      <button class="share-button btn-tertiary" id="copyBtn">
        <i class="fas fa-copy"></i> Copy Direct Link
      </button>
    </div>
    
    <!-- QR Code Section -->
    <div class="qrcode-section" id="qrcodeSection">
      <div class="qrcode-wrapper">
        <div id="qrcode"></div>
        <img src="https://assets.onecompiler.app/42swzbgaa/432b6dfa2/1000048868.png" alt="MOBE Logo">
      </div>
      <p>Scan this code to join MOBE</p>
    </div>
    
    <!-- Link Section -->
    <div class="link-section" id="linkSection">
      <div class="link-container">
        <input type="text" id="shareLink" readonly>
        <button class="copy-btn" id="copyLinkBtn"><i class="fas fa-copy"></i></button>
      </div>
      <p style="margin-top: 10px; font-size: 0.9rem;">Link expires in 24 hours</p>
    </div>
    
    <!-- Stats Section -->
    <div class="stats-section">
      <div class="stat-item">
        <div class="stat-value" id="invitesSent">0</div>
        <div class="stat-label">Invites Sent</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="playersJoined">0</div>
        <div class="stat-label">Players Joined</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="linkExpires">24h</div>
        <div class="stat-label">Link Expires</div>
      </div>
    </div>
  </div>

  <script>
    // DOM Elements
    const notificationEl = document.getElementById('notification');
    const shareBtn = document.getElementById('shareBtn');
    const qrBtn = document.getElementById('qrBtn');
    const copyBtn = document.getElementById('copyBtn');
    const copyLinkBtn = document.getElementById('copyLinkBtn');
    const qrcodeSection = document.getElementById('qrcodeSection');
    const linkSection = document.getElementById('linkSection');
    const shareLinkEl = document.getElementById('shareLink');
    const invitesSentEl = document.getElementById('invitesSent');
    const playersJoinedEl = document.getElementById('playersJoined');
    const linkExpiresEl = document.getElementById('linkExpires');
    
    // App Data
    let invitesSent = localStorage.getItem('invitesSent') || 0;
    let playersJoined = localStorage.getItem('playersJoined') || 0;
    const baseLink = "https://mobe-link-share.web.app/";
    let currentInviteLink = "";
    
    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      // Load stats
      updateStats();
      
      // Set up event listeners
      setupEventListeners();
    });
    
    function setupEventListeners() {
      // Share Button
      shareBtn.addEventListener('click', shareInviteLink);
      
      // QR Code Button
      qrBtn.addEventListener('click', toggleQRCode);
      
      // Copy Button
      copyBtn.addEventListener('click', copyDirectLink);
      
      // Copy Link Button
      copyLinkBtn.addEventListener('click', () => {
        if (currentInviteLink) {
          copyToClipboard(currentInviteLink);
        } else {
          copyToClipboard(generateInviteLink());
        }
      });
    }
    
    function generateInviteLink() {
      const timestamp = Date.now();
      const expireTime = new Date(timestamp + 24 * 60 * 60 * 1000).toISOString();
      currentInviteLink = `${baseLink}?ref=mobe_invite&expire=${encodeURIComponent(expireTime)}&sender=${generateUniqueId()}`;
      return currentInviteLink;
    }
    
    function generateUniqueId() {
      return 'xxxx-xxxx-xxxx'.replace(/[x]/g, () => {
        return Math.floor(Math.random() * 16).toString(16);
      });
    }
    
    function shareInviteLink() {
      const inviteLink = generateInviteLink();
      
      if (navigator.share) {
        navigator.share({
          title: 'Join MOBE WINTERLAND',
          text: 'I invite you to play MOBE WINTERLAND - the ultimate battle arena!',
          url: inviteLink
        }).then(() => {
          // Share successful
          incrementInvitesSent();
          showNotification('Invite shared successfully!');
        }).catch(err => {
          console.log('Error sharing:', err);
          fallbackShare(inviteLink);
        });
      } else {
        fallbackShare(inviteLink);
      }
    }
    
    function fallbackShare(link) {
      // Show link section
      shareLinkEl.value = link;
      linkSection.style.display = 'block';
      qrcodeSection.style.display = 'none';
      
      showNotification('Link generated - copy and share it manually');
    }
    
    function toggleQRCode() {
      const inviteLink = generateInviteLink();
      
      if (qrcodeSection.style.display === 'block') {
        qrcodeSection.style.display = 'none';
      } else {
        // Generate QR Code
        const qrcodeEl = document.getElementById('qrcode');
        qrcodeEl.innerHTML = '';
        new QRCode(qrcodeEl, {
          text: inviteLink,
          width: 200,
          height: 200,
          colorDark: "#000000",
          colorLight: "#ffffff",
          correctLevel: QRCode.CorrectLevel.H
        });
        
        qrcodeSection.style.display = 'block';
        linkSection.style.display = 'none';
        
        incrementInvitesSent();
        showNotification('QR Code generated');
      }
    }
    
    function copyDirectLink() {
      const inviteLink = generateInviteLink();
      copyToClipboard(inviteLink);
      incrementInvitesSent();
    }
    
    function copyToClipboard(text) {
      // Create a temporary textarea element
      const textarea = document.createElement('textarea');
      textarea.value = text;
      textarea.style.position = 'fixed';  // Prevent scrolling to bottom
      document.body.appendChild(textarea);
      textarea.select();
      
      try {
        const successful = document.execCommand('copy');
        if (successful) {
          showNotification('Link copied to clipboard!');
        } else {
          showNotification('Failed to copy link', true);
        }
      } catch (err) {
        showNotification('Error copying link', true);
        console.error('Could not copy text: ', err);
      }
      
      document.body.removeChild(textarea);
    }
    
    function incrementInvitesSent() {
      invitesSent++;
      localStorage.setItem('invitesSent', invitesSent);
      updateStats();
    }
    
    function updateStats() {
      invitesSentEl.textContent = invitesSent;
      playersJoinedEl.textContent = playersJoined;
      
      // Simulate some players joining (in a real app, this would come from your database)
      if (invitesSent > 0 && playersJoined < invitesSent) {
        setTimeout(() => {
          playersJoined = Math.min(playersJoined + Math.floor(Math.random() * 3), invitesSent);
          localStorage.setItem('playersJoined', playersJoined);
          playersJoinedEl.textContent = playersJoined;
        }, 2000);
      }
    }
    
    function showNotification(message, isError = false) {
      notificationEl.textContent = message;
      notificationEl.style.backgroundColor = isError ? 'rgba(255, 0, 0, 0.9)' : 'rgba(0, 255, 205, 0.9)';
      notificationEl.style.color = isError ? 'white' : 'var(--dark)';
      notificationEl.style.display = 'block';
      
      setTimeout(() => {
        notificationEl.style.display = 'none';
      }, 3000);
    }
    
    // Check for referral parameters in URL
    function checkReferral() {
      const params = new URLSearchParams(window.location.search);
      if (params.has('ref') && params.get('ref') === 'mobe_invite') {
        // This is a referral link
        playersJoined++;
        localStorage.setItem('playersJoined', playersJoined);
        updateStats();
        
        // Clean the URL
        window.history.replaceState({}, document.title, window.location.pathname);
      }
    }
    
    // Check for referrals when page loads
    checkReferral();
  </script>
</body>
</html>